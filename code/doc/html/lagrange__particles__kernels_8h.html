<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>dg: src/particles/lagrange_particles_kernels.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">dg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_db762ed8ec3aa0df992389441dbd75cb.html">particles</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">lagrange_particles_kernels.h File Reference<div class="ingroups"><a class="el" href="group__lagrange__particles.html">Lagrange particles</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to launch <a class="el" href="classLAGRANGE__PARTICLES.html">LAGRANGE_PARTICLES</a> kernels.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="scalar__def_8h_source.html">scalar_def.h</a>&quot;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="fullMatrix_8h_source.html">fullMatrix.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="macros_8h_source.html">macros.h</a>&quot;</code><br/>
</div>
<p><a href="lagrange__particles__kernels_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac555b7ee6d6ac3c9333255b7f08aaf62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lagrange__particles__kernels_8h.html#ac555b7ee6d6ac3c9333255b7f08aaf62">Lget_element_belong</a> (scalar *position, int prev_el, const int *neighbors, const <a class="el" href="classfullMatrix.html">fullMatrix</a>&lt; scalar &gt; XYZNodes, const int nvert, const int N_N, const int N_E)</td></tr>
<tr class="separator:ac555b7ee6d6ac3c9333255b7f08aaf62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ac387318cda1a41f74ecd1ce51e7794"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lagrange__particles__kernels_8h.html#a6ac387318cda1a41f74ecd1ce51e7794">Lget_velocity_at_position</a> (scalar *position, int el, int N_s, scalar *U, scalar *solution, scalar *avg_velocity)</td></tr>
<tr class="separator:a6ac387318cda1a41f74ecd1ce51e7794"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions to launch <a class="el" href="classLAGRANGE__PARTICLES.html">LAGRANGE_PARTICLES</a> kernels. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (C) 2012-2015, Regents of the University of Michigan </dd></dl>
<dl class="section user"><dt>License:</dt><dd>This project is released under the GNU Public License. See LICENSE. </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Marc T. Henry de Frahan <a href="#" onclick="location.href='mai'+'lto:'+'mar'+'ch'+'df@'+'um'+'ich'+'.e'+'du'; return false;">march<span style="display: none;">.nosp@m.</span>df@u<span style="display: none;">.nosp@m.</span>mich.<span style="display: none;">.nosp@m.</span>edu</a>, Computational Flow Physics Laboratory, University of Michigan </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac555b7ee6d6ac3c9333255b7f08aaf62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Lget_element_belong </td>
          <td>(</td>
          <td class="paramtype">scalar *&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prev_el</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>neighbors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfullMatrix.html">fullMatrix</a>&lt; scalar &gt;&#160;</td>
          <td class="paramname"><em>XYZNodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nvert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N_E</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Host C function to launch figure out which element the point is in </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">position</td><td>coordinates of particle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prev_el</td><td>element the point belonged to previously </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">neighbors</td><td>index of neighboring elements </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">XYZNodes</td><td>matrix of the nodal coordinates </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nvert</td><td>number of vertices per element </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_N</td><td>number of neighbors </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_E</td><td>number of elements </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>elnum index to the element the point belongs to</dd></dl>

</div>
</div>
<a class="anchor" id="a6ac387318cda1a41f74ecd1ce51e7794"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Lget_velocity_at_position </td>
          <td>(</td>
          <td class="paramtype">scalar *&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>el</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">scalar *&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">scalar *&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">scalar *&#160;</td>
          <td class="paramname"><em>avg_velocity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Host C function to get the velocity at a given position </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">position</td><td>coordinates of particle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">el</td><td>element index the particle belongs to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N_s</td><td>number of nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">U</td><td>solution in all the elements </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">solution</td><td>the nodal solution in that element </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">avg_velocity</td><td>the velocity at the position (average in element) </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="Description"></a>
Description</h1>
<p>We will return the average velocity in the element to which the particle belongs to. To be more accurate we should really be interpolation and evaluating the basis functions at that point precisely. Doing that is more expensive and harder to code, so we won't be doing velocity interpolation. In theory we could do all this directly on the GPU (to avoid some memory transfer).</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Aug 22 2017 12:58:50 for dg by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
