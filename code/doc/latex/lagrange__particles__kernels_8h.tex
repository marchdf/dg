\section{src/particles/lagrange\-\_\-particles\-\_\-kernels.h File Reference}
\label{lagrange__particles__kernels_8h}\index{src/particles/lagrange\-\_\-particles\-\_\-kernels.\-h@{src/particles/lagrange\-\_\-particles\-\_\-kernels.\-h}}


Functions to launch \doxyref{L\-A\-G\-R\-A\-N\-G\-E\-\_\-\-P\-A\-R\-T\-I\-C\-L\-E\-S}{p.}{classLAGRANGE__PARTICLES} kernels.  


{\ttfamily \#include \char`\"{}scalar\-\_\-def.\-h\char`\"{}}\\*
{\ttfamily \#include $<$math.\-h$>$}\\*
{\ttfamily \#include \char`\"{}full\-Matrix.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}macros.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int {\bf Lget\-\_\-element\-\_\-belong} (scalar $\ast$position, int prev\-\_\-el, const int $\ast$neighbors, const {\bf full\-Matrix}$<$ scalar $>$ X\-Y\-Z\-Nodes, const int nvert, const int N\-\_\-\-N, const int N\-\_\-\-E)
\item 
void {\bf Lget\-\_\-velocity\-\_\-at\-\_\-position} (scalar $\ast$position, int el, int N\-\_\-s, scalar $\ast$U, scalar $\ast$solution, scalar $\ast$avg\-\_\-velocity)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Functions to launch \doxyref{L\-A\-G\-R\-A\-N\-G\-E\-\_\-\-P\-A\-R\-T\-I\-C\-L\-E\-S}{p.}{classLAGRANGE__PARTICLES} kernels. \begin{DoxyCopyright}{Copyright}
Copyright (C) 2012-\/2015, Regents of the University of Michigan 
\end{DoxyCopyright}
\begin{DoxyParagraph}{License\-:}
This project is released under the G\-N\-U Public License. See L\-I\-C\-E\-N\-S\-E. 
\end{DoxyParagraph}
\begin{DoxyAuthor}{Author}
Marc T. Henry de Frahan {\tt marchdf@umich.\-edu}, Computational Flow Physics Laboratory, University of Michigan 
\end{DoxyAuthor}


\subsection{Function Documentation}
\index{lagrange\-\_\-particles\-\_\-kernels.\-h@{lagrange\-\_\-particles\-\_\-kernels.\-h}!Lget\-\_\-element\-\_\-belong@{Lget\-\_\-element\-\_\-belong}}
\index{Lget\-\_\-element\-\_\-belong@{Lget\-\_\-element\-\_\-belong}!lagrange_particles_kernels.h@{lagrange\-\_\-particles\-\_\-kernels.\-h}}
\subsubsection[{Lget\-\_\-element\-\_\-belong}]{\setlength{\rightskip}{0pt plus 5cm}int Lget\-\_\-element\-\_\-belong (
\begin{DoxyParamCaption}
\item[{scalar $\ast$}]{position, }
\item[{int}]{prev\-\_\-el, }
\item[{const int $\ast$}]{neighbors, }
\item[{const {\bf full\-Matrix}$<$ scalar $>$}]{X\-Y\-Z\-Nodes, }
\item[{const int}]{nvert, }
\item[{const int}]{N\-\_\-\-N, }
\item[{const int}]{N\-\_\-\-E}
\end{DoxyParamCaption}
)}\label{lagrange__particles__kernels_8h_ac555b7ee6d6ac3c9333255b7f08aaf62}
Host C function to launch figure out which element the point is in 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em position} & coordinates of particle \\
\hline
\mbox{\tt in}  & {\em prev\-\_\-el} & element the point belonged to previously \\
\hline
\mbox{\tt in}  & {\em neighbors} & index of neighboring elements \\
\hline
\mbox{\tt in}  & {\em X\-Y\-Z\-Nodes} & matrix of the nodal coordinates \\
\hline
\mbox{\tt in}  & {\em nvert} & number of vertices per element \\
\hline
\mbox{\tt in}  & {\em N\-\_\-\-N} & number of neighbors \\
\hline
\mbox{\tt in}  & {\em N\-\_\-\-E} & number of elements \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
elnum index to the element the point belongs to
\end{DoxyReturn}
\index{lagrange\-\_\-particles\-\_\-kernels.\-h@{lagrange\-\_\-particles\-\_\-kernels.\-h}!Lget\-\_\-velocity\-\_\-at\-\_\-position@{Lget\-\_\-velocity\-\_\-at\-\_\-position}}
\index{Lget\-\_\-velocity\-\_\-at\-\_\-position@{Lget\-\_\-velocity\-\_\-at\-\_\-position}!lagrange_particles_kernels.h@{lagrange\-\_\-particles\-\_\-kernels.\-h}}
\subsubsection[{Lget\-\_\-velocity\-\_\-at\-\_\-position}]{\setlength{\rightskip}{0pt plus 5cm}void Lget\-\_\-velocity\-\_\-at\-\_\-position (
\begin{DoxyParamCaption}
\item[{scalar $\ast$}]{position, }
\item[{int}]{el, }
\item[{int}]{N\-\_\-s, }
\item[{scalar $\ast$}]{U, }
\item[{scalar $\ast$}]{solution, }
\item[{scalar $\ast$}]{avg\-\_\-velocity}
\end{DoxyParamCaption}
)}\label{lagrange__particles__kernels_8h_a6ac387318cda1a41f74ecd1ce51e7794}
Host C function to get the velocity at a given position 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em position} & coordinates of particle \\
\hline
\mbox{\tt in}  & {\em el} & element index the particle belongs to \\
\hline
\mbox{\tt in}  & {\em N\-\_\-s} & number of nodes \\
\hline
\mbox{\tt in}  & {\em U} & solution in all the elements \\
\hline
\mbox{\tt in}  & {\em solution} & the nodal solution in that element \\
\hline
\mbox{\tt out}  & {\em avg\-\_\-velocity} & the velocity at the position (average in element) \\
\hline
\end{DoxyParams}
\subsection{Description}\label{scalar__def_8h_Description}
We will return the average velocity in the element to which the particle belongs to. To be more accurate we should really be interpolation and evaluating the basis functions at that point precisely. Doing that is more expensive and harder to code, so we won't be doing velocity interpolation. In theory we could do all this directly on the G\-P\-U (to avoid some memory transfer).